-- this file is generated thanks to the following command :
-- php bin/console doctrine:schema:create --dump-sql > import_bdd.sql

-- BEGIN
-- CREATE part
CREATE TABLE cblog_article (
	id BIGINT AUTO_INCREMENT NOT NULL,
	id_user BIGINT DEFAULT NULL,
	time BIGINT NOT NULL,
	url VARCHAR(100) NOT NULL,
	title VARCHAR(100) NOT NULL,
	content LONGTEXT NOT NULL,
	INDEX IDX_ARTICLE_USER_ID (id_user),
	UNIQUE INDEX UC_ARTICLE_URL (url),
	PRIMARY KEY(id)
) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;

CREATE TABLE cblog_comment (
	id BIGINT AUTO_INCREMENT NOT NULL,
	id_article BIGINT DEFAULT NULL,
	message LONGTEXT NOT NULL,
	name VARCHAR(20) NOT NULL,
	time BIGINT NOT NULL,
	INDEX IDX_COMMENT_ARTICLE_ID (id_article),
	PRIMARY KEY(id)
) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;

CREATE TABLE cblog_config (
	name VARCHAR(100) NOT NULL,
	value LONGTEXT NOT NULL,
	PRIMARY KEY(name)
) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;

CREATE TABLE cblog_page (
	id BIGINT AUTO_INCREMENT NOT NULL,
	url VARCHAR(100) NOT NULL,
	title VARCHAR(100) NOT NULL,
	content LONGTEXT NOT NULL,
	UNIQUE INDEX UC_PAGE_URL (url),
	PRIMARY KEY(id)
) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;

CREATE TABLE cblog_user (
	id BIGINT AUTO_INCREMENT NOT NULL,
	email VARCHAR(320) NOT NULL,
	username VARCHAR(20) NOT NULL,
	password VARCHAR(60) NOT NULL,
	UNIQUE INDEX UC_USER_EMAIL (email),
	UNIQUE INDEX UC_USER_USERNAME (username),
	UNIQUE INDEX UC_USER_PASSWORD (password),
	PRIMARY KEY(id)
) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;

-- FOREIGN KEY part
ALTER TABLE cblog_article ADD CONSTRAINT FK_295485986B3CA4B FOREIGN KEY (id_user) REFERENCES cblog_user (id) ON DELETE SET NULL;
ALTER TABLE cblog_comment ADD CONSTRAINT FK_BF1AD992DCA7A716 FOREIGN KEY (id_article) REFERENCES cblog_article (id) ON DELETE CASCADE;

-- END
